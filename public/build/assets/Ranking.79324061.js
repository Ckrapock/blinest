import{e as j,j as m,k as B,l as S,C as M,o as s,b as l,d as _,w as f,c as N,g as c,a as o,M as E,F as v,y as x,n as P,u as T,t as i,h as w}from"./app.2ccf841f.js";import{C as V}from"./Card.53d0f134.js";import{_ as $}from"./Icon.6689216d.js";import z from"./PodiumModal.5121460f.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./Modal.95e75e17.js";import"./Spinner.ad70554a.js";const F={class:"flex w-full items-center justify-between"},L=o("h3",{class:"text-xl font-bold"},"Classement",-1),O=["title"],R={class:"h-64 overflow-y-scroll pr-2 md:h-80 2xl:h-96"},D={class:"font-bold text-xl justify-center items-center flex px-4"},G={class:"flex flex-grow flex-col"},I={class:"mb-2"},U={key:0,class:"text-[9px] uppercase"},q={class:"flex items-center"},A={class:"relative mr-3 flex items-center rounded bg-purple-300 px-1 text-[10px] font-bold uppercase text-neutral-500 text-white"},H={key:0,class:"mr-1 text-orange-500"},J=o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"h-3 w-3"},[o("path",{"fill-rule":"evenodd",d:"M13.5 4.938a7 7 0 11-9.006 1.737c.202-.257.59-.218.793.039.278.352.594.672.943.954.332.269.786-.049.773-.476a5.977 5.977 0 01.572-2.759 6.026 6.026 0 012.486-2.665c.247-.14.55-.016.677.238A6.967 6.967 0 0013.5 4.938zM14 12a4 4 0 01-4 4c-1.913 0-3.52-1.398-3.91-3.182-.093-.429.44-.643.814-.413a4.043 4.043 0 001.601.564c.303.038.531-.24.51-.544a5.975 5.975 0 011.315-4.192.447.447 0 01.431-.16A4.001 4.001 0 0114 12z","clip-rule":"evenodd"})],-1),K=[J],Q={key:1,class:"absolute -right-2 -top-1 ml-2 flex h-3 w-3 items-center justify-center rounded-full bg-teal-600 text-[8px] text-neutral-100"},W={key:0,class:"relative mr-3 flex rounded bg-neutral-300 px-1 text-[10px] font-bold uppercase text-neutral-500 text-white"},X=o("sup",null,"PTS",-1),le={__name:"Ranking",props:{room:Object,users:Array,channel:String,data:Object},setup(b){const d=b,k=j().props.value.auth.user,y=m([]),n=m(d==null?void 0:d.users),p=m(null),u=m(!1);return B(()=>d.users,t=>{n.value=t}),S(()=>{Echo.channel(d.channel).listen("NewScore",t=>{y.value.push(t.score);let a=n.value.findIndex(e=>e.id===t.score.user_id);n.value[a].score.total=t.score.total,n.value[a].score.points=t.score.points,n.value[a].score.answers.push(...t.score.answers),n.value.sort((e,h)=>h.score.total-e.score.total)}).listen("TrackPlayed",t=>{p.value=t.track,n.value.map(a=>{if(a.score)return a.score.answers=[]})}).listen("RoundStarted",()=>{n.value.forEach(t=>{t.score.total=0})})}),M(()=>{Echo.leave(d.channel)}),(t,a)=>(s(),l("div",null,[_(V,null,{header:f(()=>[o("div",F,[L,o("button",{type:"button",onClick:a[0]||(a[0]=e=>u.value=!0),title:t.__("Show rankings for this room")},[_($,{name:"podium",class:"mr-2 h-8 w-8"})],8,O)])]),default:f(()=>[o("div",R,[_(E,{name:"flip-list",tag:"ul"},{default:f(()=>[(s(!0),l(v,null,x(n.value,(e,h)=>(s(),l("li",{key:e.id,class:P(["flex items-center rounded border-b border-neutral-600 px-2 py-4",{"bg-neutral-700":T(k).id===e.id}])},[o("div",D,i(h+1),1),o("div",G,[o("div",I,[w(i(e.name)+" ",1),e.team?(s(),l("sup",U,"["+i(e.team.name)+"]",1)):c("",!0)]),o("div",q,[e.score?(s(!0),l(v,{key:0},x(e.score.answers,r=>(s(),l("span",A,[r.speedBonus?(s(),l("span",H,K)):c("",!0),w(" "+i(t.__(r.name))+" ",1),r.order<4?(s(),l("span",Q,i(r.order),1)):c("",!0)]))),256)):c("",!0),p.value?(s(!0),l(v,{key:1},x(p.value.answers,r=>{var g;return s(),l("span",null,[(g=e==null?void 0:e.score)!=null&&g.answers.find(C=>C.id===r.id)?c("",!0):(s(),l("span",W,i(t.__(r.name)),1))])}),256)):c("",!0)])]),o("div",null,[w(i(e!=null&&e.score?e.score.total:0)+" ",1),X])],2))),128))]),_:1})])]),_:1}),u.value?(s(),N(z,{key:0,room:b.room,show:u.value,onClose:a[1]||(a[1]=e=>u.value=!1)},null,8,["room","show"])):c("",!0)]))}};export{le as default};

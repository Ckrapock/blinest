import{o as d,b as u,a as e,d as s,w as h,u as y,L as B,r as H,g as w,z as k,e as M,t as _,h as m,j as $,G as j,F as C,y as E,c as S,k as z,m as L,H as T}from"./app.258a8340.js";import{L as F}from"./Icon.5ed47614.js";import{_ as N}from"./Dropdown.8bb686e2.js";import{_ as b,a as R}from"./Volume.0b53fb6c.js";import{_ as A,L as P,F as O}from"./LanguageSwitcher.0c26ca67.js";import"./_defineProperty.27cae424.js";import{S as U}from"./Spinner.d6c34fc8.js";import{_ as G}from"./TextInput.53c9a2da.js";import{_ as D}from"./Modal.c8b8679a.js";import{C as q}from"./Card.73fe1151.js";import I from"./Player.3061b060.js";import J from"./UserInput.128ffe07.js";import K from"./Answers.06b99864.js";import Q from"./Ranking.b314bfed.js";import W from"./FinishedRoundModal.e8f08358.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./Controls.f929be84.js";const X={class:"text-neutral-200"},Y=e("div",{id:"dropdown"},null,-1),Z={class:"md:flex md:flex-col"},ee={class:"md:flex md:h-screen md:flex-col"},se={class:"md:flex md:flex-shrink-0"},oe={class:"flex items-center justify-between px-12 py-2 md:flex-shrink-0"},te=e("svg",{class:"h-6 w-6 fill-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})],-1),le={class:"mt-2 rounded px-8 py-4 shadow-lg"},ne={class:"md:text-md items-center grid w-full grid-cols-2 p-4 text-sm md:px-12 md:py-0"},ae={class:"flex items-center justify-end"},re={class:"md:flex md:flex-grow md:overflow-hidden"},ie={key:0,class:"md:flex-1"},de={__name:"RoomLayout",setup(a){return(t,o)=>(d(),u("div",X,[Y,e("div",Z,[e("div",ee,[e("div",se,[e("div",oe,[s(y(B),{class:"mt-1",href:"/"},{default:h(()=>[s(F,{class:"fill-white",width:"120",height:"28"})]),_:1}),s(N,{class:"md:hidden",placement:"bottom-end"},{default:h(()=>[te]),dropdown:h(()=>[e("div",le,[s(b)])]),_:1})]),e("div",ne,[s(b,{class:"hidden w-auto md:flex"}),e("div",ae,[s(A,{class:"mr-4"}),s(P,{class:"mr-4"}),s(R)])])]),e("div",re,[s(k,{name:"slide-right",appear:""},{default:h(()=>[t.$slots.default?(d(),u("div",ie,[s(O),H(t.$slots,"default")])):w("",!0)]),_:3})])])])]))}},me={class:"my-1 text-sm"},ce={class:"font-bold mr-1"},ue={class:""},he={__name:"Message",props:{message:Object},setup(a){return M().props.value.auth.user,(t,o)=>(d(),u("div",me,[e("span",ce,_(a.message.user.name),1),e("span",ue,": "+_(a.message.body),1)]))}},_e={class:"flex flex-col h-full"},fe={class:"flex p-2"},ve=["onSubmit"],pe=e("button",{type:"submit",class:"rounded-r bg-teal-600 p-2 text-neutral-100"},"Send",-1),ge={__name:"Chat",props:{room:Object},setup(a){const t=a,o=`chat-room.${t.room.id}`,l=m(""),r=m(t.room.latest_messages);M().props.value.auth.user;const c=m();$(()=>{Echo.private(o).listen("NewMessage",i=>{console.log(i.message),r.value.unshift(i.message),f()})}),j(()=>{Echo.leave(o)});const x=()=>{axios.post(`/rooms/${t.room.id}/message`,{body:l.value}).then(i=>{l.value=""})},f=()=>{let i=c.value;i.scrollTop=i.scrollHeight+1e3};return(i,g)=>(d(),u("div",_e,[e("div",{ref_key:"messenger",ref:c,class:"flex-1 overflow-y-scroll flex flex-col-reverse p-2"},[(d(!0),u(C,null,E(r.value,v=>(d(),S(he,{key:v.id,message:v},null,8,["message"]))),128))],512),e("div",fe,[e("form",{onSubmit:z(x,["prevent"]),class:"flex"},[s(G,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=v=>l.value=v),class:"rounded-r-none"},null,8,["modelValue"]),pe],40,ve)])]))}},we=e("h3",{class:"flex items-center pl-4 text-xl font-bold"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mr-2 h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"})]),L(" Autoriser la lecture ")],-1),xe={class:"p-4"},$e={class:"mt-4 flex items-start text-sm text-neutral-400 bg-neutral-200 p-2 rounded"},be=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mr-2 h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})],-1),ye={class:"mt-8 flex justify-end"},ke={__name:"UserGestureModal",setup(a){const t=m(!1);return $(()=>{var o=!0,l=document.createElement("audio").play();l instanceof Promise&&l.catch(function(r){if(r.name=="NotAllowedError")o=!1;else throw r}).then(function(){o||(t.value=!0)})}),(o,l)=>(d(),S(D,{show:t.value,onClose:l[1]||(l[1]=r=>t.value=!1)},{default:h(()=>[s(q,null,{header:h(()=>[we]),default:h(()=>[e("div",xe,[L(_(o.__("The browser needs your permission to start playing audio files."))+" ",1),e("p",$e,[be,e("span",null,_(o.__("This message will appear every time you go directly to a room without going through the homepage.")),1)]),e("div",ye,[e("button",{class:"btn-primary",onClick:l[0]||(l[0]=r=>t.value=!1)},_(o.__("Let's go!")),1)])])]),_:1})]),_:1},8,["show"]))}},Me={key:0,class:"flex h-full w-full items-center justify-center"},je={key:0,class:"h-full md:flex"},Ce={class:"relative flex-1 overflow-y-auto p-4 md:px-12 md:py-8","scroll-region":""},Se={class:"prose mb-4 dark:prose-invert"},Le={class:"mb-4 md:mb-8"},Ve={class:"grid md:grid-cols-2 md:gap-8"},Be=["title"],He=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),Ee=[He],ze={key:0,class:"flex h-96 w-full flex-shrink-0 flex-col border-neutral-700 bg-neutral-800 transition-all duration-300 md:h-full md:w-1/5 rounded-tl"},Ye={__name:"Show",props:{room:Object},setup(a){const t=a,o=`rooms.${t.room.id}`,l=m(null),r=m(!1),c=m(null),x=m(null),f=m(!1),i=m(!0);$(()=>{Echo.join(o).here(n=>{c.value=n,g()}).joining(n=>{c.value.push(n)}).leaving(n=>{c.value=c.value.filter(p=>p.id!==n.id)}).error(n=>{console.error(n)})}),j(()=>{Echo.leave(o)});const g=()=>{axios.get(`/rooms/${t.room.id}/joined`).then(()=>{r.value=!0,v()})},v=()=>{Echo.channel(o).listen("RoundStarted",n=>{console.warn("Round started"),l.value=n.round,f.value=!1}).listen("RoundFinished",n=>{console.warn("Round finished"),l.value=null,f.value=!0}).listen("TrackPlayed",n=>{l.value=n.round,t.room.vavlue=n.room})};return(n,p)=>(d(),u(C,null,[s(y(T),{title:a.room.name},null,8,["title"]),s(de,null,{default:h(()=>[r.value?w("",!0):(d(),u("div",Me,[s(U),e("h2",null,_(n.__("Loading"))+"...",1)])),s(k,{name:"slide-right"},{default:h(()=>[r.value?(d(),u("div",je,[e("div",Ce,[e("article",Se,[e("h2",null,_(a.room.name),1)]),e("div",Le,[s(I,{room:a.room,channel:o},null,8,["room"]),s(J,{channel:o})]),e("div",Ve,[s(K,{class:"mb-4 md:mb-8",users:c.value,channel:o},null,8,["users"]),s(Q,{class:"mb-4 md:mb-8",users:c.value,channel:o,data:x.value},null,8,["users","data"])]),e("button",{class:"absolute right-0 top-5 hidden rounded-l-lg bg-neutral-800 p-2 md:block",onClick:p[0]||(p[0]=V=>i.value=!i.value),title:n.__("Hide/Show chatbox")},Ee,8,Be)]),i.value?(d(),u("div",ze,[s(ge,{room:a.room},null,8,["room"])])):w("",!0)])):w("",!0)]),_:1}),s(W,{show:f.value,onClose:p[1]||(p[1]=V=>f.value=!1)},null,8,["show"]),s(ke)]),_:1})],64))}};export{Ye as default};

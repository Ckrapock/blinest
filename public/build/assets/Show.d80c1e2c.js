import{o as a,b as m,a as e,d as n,w as v,r as V,k as w,s as k,e as y,t as _,g as c,i as b,E as M,m as x,F as j,y as B,c as C,j as E,u as A,H}from"./app.e47e5905.js";import{F as L}from"./LanguageSwitcher.004676ec.js";import"./_defineProperty.14bd0892.js";import{_ as T}from"./Navbar.5230c35c.js";import{S as F}from"./Spinner.ecf8755a.js";import{_ as N}from"./TextInput.a612d17f.js";import{_ as R}from"./Modal.e60b654c.js";import{C as P}from"./Card.96514456.js";import z from"./Player.41ddc52e.js";import O from"./UserInput.e192f0ab.js";import U from"./Answers.16c1f20b.js";import D from"./Ranking.7ac1c72e.js";import G from"./FinishedRoundModal.914bada1.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./Dropdown.c59b2b1e.js";import"./Icon.b99ae8d7.js";import"./Logo.f4483971.js";import"./pickBy.615c9b24.js";import"./debounce.f308b35d.js";import"./Controls.f3d0e83f.js";import"./PodiumModal.dea6e221.js";const q={class:"text-neutral-200"},I=e("div",{id:"dropdown"},null,-1),J={class:"md:flex md:flex-col"},K={class:"md:flex md:h-screen md:flex-col"},Q={class:"md:flex md:flex-grow md:overflow-hidden"},W={key:0,class:"md:flex-1"},X={__name:"RoomLayout",setup(r){return(t,o)=>(a(),m("div",q,[I,e("div",J,[e("div",K,[n(T),e("div",Q,[n(k,{name:"slide-right",appear:""},{default:v(()=>[t.$slots.default?(a(),m("div",W,[n(L),V(t.$slots,"default")])):w("",!0)]),_:3})])])])]))}},Y={class:"my-1 text-sm"},Z={class:"font-bold mr-1"},ee={class:""},oe={__name:"Message",props:{message:Object},setup(r){return y().props.value.auth.user,(t,o)=>(a(),m("div",Y,[e("span",Z,_(r.message.user.name),1),e("span",ee,": "+_(r.message.body),1)]))}},se={class:"flex h-full flex-col"},te={class:"flex justify-center px-2 py-4"},le=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1),ne={key:1,class:"flex items-center text-green-500"},re=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})],-1),ae={class:"flex p-2"},ie=["onSubmit"],de=e("button",{type:"submit",class:"rounded-r bg-teal-600 p-2 text-neutral-100"},"Send",-1),ue={__name:"Chat",props:{room:Object},setup(r){const t=r,o=`chat-room.${t.room.id}`,l=c(""),d=c(t.room.latest_messages);y().props.value.auth.user;const h=c(),g=c(null);b(()=>{Echo.private(o).listen("NewMessage",i=>{console.log(i.message),d.value.unshift(i.message),$()})}),M(()=>{Echo.leave(o)});const f=()=>{axios.post(`/rooms/${t.room.id}/alert`).then(i=>{g.value=!0})},p=()=>{axios.post(`/rooms/${t.room.id}/message`,{body:l.value}).then(i=>{l.value=""})},$=()=>{let i=h.value;i.scrollTop=i.scrollHeight+1e3};return(i,s)=>(a(),m("div",se,[e("div",te,[g.value?(a(),m("div",ne,[re,x(" "+_(i.__("Alert sent")),1)])):(a(),m("button",{key:0,class:"btn-secondary btn-sm bg-neutral-700",onClick:f},[le,x(" "+_(i.__("Alerting moderators")),1)]))]),e("div",{ref_key:"messenger",ref:h,class:"flex flex-1 flex-col-reverse overflow-y-scroll p-2"},[(a(!0),m(j,null,B(d.value,u=>(a(),C(oe,{key:u.id,message:u},null,8,["message"]))),128))],512),e("div",ae,[e("form",{onSubmit:E(p,["prevent"]),class:"flex"},[n(N,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=u=>l.value=u),class:"rounded-r-none"},null,8,["modelValue"]),de],40,ie)])]))}},ce=e("h3",{class:"flex items-center pl-4 text-xl font-bold"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mr-2 h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"})]),x(" Autoriser la lecture ")],-1),me={class:"p-4"},he={class:"mt-4 flex items-start text-sm text-neutral-400 bg-neutral-200 p-2 rounded"},_e=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mr-2 h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})],-1),fe={class:"mt-8 flex justify-end"},ve={__name:"UserGestureModal",setup(r){const t=c(!1);return b(()=>{var o=!0,l=document.createElement("audio").play();l instanceof Promise&&l.catch(function(d){if(d.name=="NotAllowedError")o=!1;else throw d}).then(function(){o||(t.value=!0)})}),(o,l)=>(a(),C(R,{show:t.value,onClose:l[1]||(l[1]=d=>t.value=!1)},{default:v(()=>[n(P,null,{header:v(()=>[ce]),default:v(()=>[e("div",me,[x(_(o.__("The browser needs your permission to start playing audio files."))+" ",1),e("p",he,[_e,e("span",null,_(o.__("This message will appear every time you go directly to a room without going through the homepage.")),1)]),e("div",fe,[e("button",{class:"btn-primary",onClick:l[0]||(l[0]=d=>t.value=!1)},_(o.__("Let's go!")),1)])])]),_:1})]),_:1},8,["show"]))}},pe={key:0,class:"flex h-full w-full items-center justify-center"},ge={key:0,class:"h-full md:flex"},we={class:"relative flex-1 overflow-y-auto p-4 md:px-12 md:py-8","scroll-region":""},xe={class:"mb-4 flex items-center justify-between"},$e={class:"text-xl font-bold"},be={class:"mb-4 md:mb-8"},ke={class:"grid md:grid-cols-2 md:gap-8"},ye=["title"],Me=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),je=[Me],Ce={key:0,class:"flex h-96 w-full flex-shrink-0 flex-col rounded-tl border-neutral-700 bg-neutral-800 transition-all duration-300 md:h-full md:w-1/5"},Qe={__name:"Show",props:{room:Object},setup(r){const t=r,o=`rooms.${t.room.id}`,l=c(null),d=c(!1),h=c(null),g=c(null),f=c(!1),p=c(!0);b(()=>{Echo.join(o).here(s=>{h.value=s,$()}).joining(s=>{h.value.push(s)}).leaving(s=>{h.value=h.value.filter(u=>u.id!==s.id)}).error(s=>{console.error(s)})}),M(()=>{Echo.leave(o)});const $=()=>{axios.get(`/rooms/${t.room.id}/joined`).then(()=>{d.value=!0,i()})},i=()=>{Echo.channel(o).listen("RoundStarted",s=>{console.warn("Round started"),l.value=s.round,f.value=!1}).listen("RoundFinished",s=>{console.warn("Round finished"),l.value=null,f.value=!0}).listen("TrackPlayed",s=>{l.value=s.round,t.room.vavlue=s.room})};return(s,u)=>(a(),m(j,null,[n(A(H),{title:r.room.name},null,8,["title"]),n(X,null,{default:v(()=>[d.value?w("",!0):(a(),m("div",pe,[n(F),e("h2",null,_(s.__("Loading"))+"...",1)])),n(k,{name:"slide-right"},{default:v(()=>[d.value?(a(),m("div",ge,[e("div",we,[e("article",xe,[e("h2",$e,_(r.room.name),1)]),e("div",be,[n(z,{room:r.room,channel:o},null,8,["room"]),n(O,{channel:o})]),e("div",ke,[n(U,{class:"mb-4 md:mb-8",users:h.value,channel:o},null,8,["users"]),n(D,{class:"mb-4 md:mb-8",room:r.room,users:h.value,channel:o,data:g.value},null,8,["room","users","data"])]),e("button",{class:"absolute right-0 top-5 hidden rounded-l-lg bg-neutral-800 p-2 md:block",onClick:u[0]||(u[0]=S=>p.value=!p.value),title:s.__("Hide/Show chatbox")},je,8,ye)]),p.value?(a(),m("div",Ce,[n(ue,{room:r.room},null,8,["room"])])):w("",!0)])):w("",!0)]),_:1}),n(G,{show:f.value,onClose:u[1]||(u[1]=S=>f.value=!1)},null,8,["show"]),n(ve)]),_:1})],64))}};export{Qe as default};

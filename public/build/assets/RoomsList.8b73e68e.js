import{q as N,o as s,c as $,w as v,a as e,b as a,t as l,d as _,y as S,F as V,u as m,n as M,g as A,l as I,h as y,B as P,i as U,z as O,m as j,L as H}from"./app.6178a65b.js";import{_ as C}from"./Icon.b321052c.js";import{C as T}from"./Card.2e30a0a3.js";import{_ as B}from"./TextInput.8c9ba0ba.js";import{_ as W}from"./Pagination.d3597665.js";import{_ as q}from"./Modal.ee4257c7.js";import{_ as G}from"./SelectInput.2386ab38.js";import{S as J}from"./Spinner.968ed9fc.js";import{_ as E}from"./LanguageSwitcher.06c97ed0.js";import{t as K,p as Q}from"./pickBy.99845672.js";import{d as R}from"./debounce.f0f8076e.js";const X=["onSubmit"],Y={class:"px-6 py-4"},Z={key:0,class:"text-lg"},ee={key:1,class:"text-lg"},se={class:"mt-4 flex flex-wrap"},te=["value"],le={class:"flex items-center justify-between bg-neutral-800 px-2 py-4 text-right"},ae=["disabled"],oe={class:"flex items-center"},re=["disabled"],ne=["disabled"],ie={__name:"TrackAnswerForm",props:{answer:{type:Object,default(){return{answer_type_id:1,value:"",score:"0.5"}}},show:[Boolean,Number],maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},answer_types:Object},emits:["close"],setup(n,{emit:h}){const o=n,t=N({answer_type_id:o.answer?o.answer.answer_type_id:1,value:o.answer?o.answer.value:"",score:o.answer?o.answer.score:.5}),p=()=>{h("close")},w=()=>{var i;(i=t==null?void 0:t.value)!=null&&i.id?f():k()},f=()=>{t.put(route("tracks.answers.update",[o.show,o.answer.id]),{preserveScroll:!0,preserveState:!1,onSuccess:()=>{p()}})},k=()=>{t.post(route("tracks.answers.store",o.show),{preserveScroll:!0,preserveState:!1,onSuccess:()=>{p()}})},u=()=>{t.delete(route("tracks.answers.delete",[o.show,o.answer.id]),{preserveScroll:!0,preserveState:!1,onSuccess:()=>{p()}})};return(i,d)=>(s(),$(q,{show:n.show,"max-width":n.maxWidth,closeable:n.closeable,onClose:p},{default:v(()=>[e("form",{onSubmit:I(w,["prevent"])},[e("div",Y,[n.answer?(s(),a("div",Z,l(i.__("Edit Answer")),1)):(s(),a("div",ee,l(i.__("Add Answer")),1)),e("div",se,[_(G,{modelValue:m(t).answer_type_id,"onUpdate:modelValue":d[0]||(d[0]=b=>m(t).answer_type_id=b),error:m(t).errors.answer_type_id,class:"w-full pb-8 pr-6 lg:w-1/2",label:i.__("Type")},{default:v(()=>[(s(!0),a(V,null,S(n.answer_types,b=>(s(),a("option",{value:b.id},l(i.__(b.name)),9,te))),256))]),_:1},8,["modelValue","error","label"]),_(B,{modelValue:m(t).score,"onUpdate:modelValue":d[1]||(d[1]=b=>m(t).score=b),type:"number",step:"0.5",min:"0",max:"99",error:m(t).errors.score,class:"w-full pb-8 pr-6 lg:w-1/2",label:i.__("Score")},null,8,["modelValue","error","label"]),_(B,{modelValue:m(t).value,"onUpdate:modelValue":d[2]||(d[2]=b=>m(t).value=b),error:m(t).errors.value,class:"w-full pb-8 pr-6",label:i.__("Answer")},null,8,["modelValue","error","label"])])]),e("div",le,[n.answer&&n.answer.id?(s(),a("button",{key:0,type:"button",class:M(["mx-2 text-red-400",{"opacity-25":m(t).processing}]),disabled:m(t).processing,onClick:u},l(i.__("Delete")),11,ae)):A("",!0),e("div",oe,[e("button",{class:"btn-secondary mx-2 bg-gray-400",onClick:p},l(i.__("Close")),1),n.answer&&n.answer.id?(s(),a("button",{key:0,type:"submit",class:M(["btn-primary ml-2",{"opacity-25":m(t).processing}]),disabled:m(t).processing},l(i.__("Update")),11,re)):(s(),a("button",{key:1,type:"submit",class:M(["btn-primary ml-2",{"opacity-25":m(t).processing}]),disabled:m(t).processing},l(i.__("Add")),11,ne))])])],40,X)]),_:1},8,["show","max-width","closeable"]))}},de={key:1,class:"mr-2 flex h-10 w-10 flex-shrink-0 items-center justify-center rounded-full bg-neutral-800"},L={__name:"MiniPlayer",props:{track:Object},setup(n){const h=n,o=new Audio,t=y(!1),p=y(!1);P(()=>{f()});const w=()=>{t.value=!0,p.value=!0,o.src=h.track.preview_url,o.addEventListener("canplaythrough",()=>{t.value=!1,o.play()})},f=()=>{p.value=!1,o.pause()};return(k,u)=>p.value?t.value?(s(),a("div",de,[_(J,{class:"h-full w-full"})])):(s(),$(C,{key:2,name:"stop",class:"mr-2 h-12 w-12 flex-shrink-0 cursor-pointer",onClick:f})):(s(),$(C,{key:0,name:"play",class:"mr-2 h-12 w-12 flex-shrink-0 cursor-pointer",onClick:w}))}},ce={class:"flex w-full items-center justify-between"},ue={class:"text-xl font-bold"},pe={class:"mb-4 flex flex-wrap gap-2 p-2"},me={key:0,class:"max-w-50 max-h-80 overflow-y-auto"},_e={class:"relative cursor-pointer border-b border-neutral-200 px-1 py-2 hover:bg-neutral-100 hover:text-neutral-900"},he={class:"flex items-center"},fe={class:"mr-2 flex w-80 flex-1 flex-col"},ve={class:"max-w-[16rem] truncate break-normal font-bold"},be={class:"max-w-[16rem] truncate break-normal text-sm"},ye={key:0,class:"ml-auto"},we=["disabled","onClick"],ke={key:1,class:"ml-auto"},xe=["disabled","onClick"],ge={class:"mx-4 overflow-x-auto"},$e={class:"w-full whitespace-nowrap"},Ce={class:"text-left font-bold"},Se={class:"px-6 pb-4 pt-6",colspan:"3"},Ve={class:"px-6 pb-4 pt-6",colspan:"2"},Ae={class:"px-6 pb-4 pt-6",colspan:"2"},je={class:"border-t"},Be=["href"],Me={class:"border-t"},Oe={class:"flex items-center justify-center px-2 py-4 focus:text-blinest-500"},Ue={class:"border-t"},Ne={class:"flex flex-col items-start px-6 py-4 text-sm focus:text-blinest-500"},Te=["onClick"],Fe={class:"font-bold"},Le=["onClick"],Ee={class:"border-t"},Re={class:"flex items-start px-6 py-4 text-center text-sm"},ze={class:"border-t"},De={class:"flex items-start px-6 py-4 text-center text-sm focus:text-blinest-500"},Ie={class:"border-t"},Pe={class:"flex flex-col items-start px-6 py-4 text-sm focus:text-blinest-500"},He={class:"border-t"},We={key:0},qe={class:"border-t px-6 py-4",colspan:"4"},ys={__name:"TracksManager",props:{playlist:Object,answer_types:Object,tracks:Object,filters:{type:Object,default:{search:""}}},setup(n){const h=n,o=N({search:h.filters.search}),t=y(null),p=y(!1),w=y(!1),f=y("");y("");const k=y(!1),u=y([]);U(f,R(()=>{i()},300)),U(o,K(()=>{O.Inertia.get(route("admin.playlists.edit",h.playlist),Q(o),{preserveScroll:!0,preserveState:!0})},150),{deep:!0});const i=()=>{f.value.length>1?(k.value=!0,axios.get(route("tracks.search",h.playlist.id)+"?term="+f.value).then(c=>{u.value=c.data.tracks,k.value=!1})):u.value=[]},d=c=>{p.value=c.id},b=(c,x=null)=>{t.value=x,w.value=c.id},z=()=>{p.value=!1,w.value=!1},D=c=>{O.Inertia.post(route("playlists.tracks.store",h.playlist.id),c,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{i()}})},F=c=>{let x=c.added?c.added.id:c.id;O.Inertia.delete(route("tracks.delete",x),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{i()}})};return(c,x)=>(s(),$(T,null,{header:v(()=>[e("div",ce,[e("h3",ue,l(c.__("Tracks manager"))+" ("+l(n.tracks.total)+")",1),_(B,{modelValue:m(o).search,"onUpdate:modelValue":x[0]||(x[0]=r=>m(o).search=r),"prepend-icon":"search",placeholder:c.__("Search in playlist")+"..."},null,8,["modelValue","placeholder"])])]),default:v(()=>[e("div",null,[e("div",pe,[_(E,{placement:"bottom-start","auto-close":!1,onClosed:x[2]||(x[2]=r=>f.value="")},{default:v(()=>[_(B,{modelValue:f.value,"onUpdate:modelValue":x[1]||(x[1]=r=>f.value=r),"prepend-icon":"plus","append-icon":"cheveron-down",loading:k.value,placeholder:c.__("Search on Deezer, Spotify and Apple music...")},null,8,["modelValue","loading","placeholder"])]),dropdown:v(()=>[u.value.length?(s(),a("ul",me,[(s(!0),a(V,null,S(u.value,r=>(s(),a("li",_e,[e("div",he,[e("div",null,[_(C,{name:r.provider,title:r.provider,class:"mr-2 h-6 w-6 flex-shrink-0"},null,8,["name","title"])]),e("div",null,[(s(),$(L,{key:`mini-player-results-${r.id}`,track:r},null,8,["track"]))]),e("div",fe,[e("span",ve,l(r.artist_name),1),e("span",be,l(r.track_name),1)]),r.added?(s(),a("div",ke,[e("button",{disabled:k.value,class:"btn-danger",type:"button",onClick:g=>F(r)},l(c.__("Remove")),9,xe)])):(s(),a("div",ye,[e("button",{disabled:k.value,class:"btn-primary",type:"button",onClick:g=>D(r)},l(c.__("Add")),9,we)]))])]))),256))])):A("",!0)]),_:1})]),e("div",ge,[e("table",$e,[e("tr",Ce,[e("th",Se,l(c.__("Answers")),1),e("th",Ve,l(c.__("Votes")),1),e("th",Ae,l(c.__("Created at")),1)]),(s(!0),a(V,null,S(n.tracks.data,r=>(s(),a("tr",{key:r.id,class:"hover:bg-neutral-200"},[e("td",je,[e("a",{target:"_blank",href:r.provider_url,class:"flex items-center justify-center px-2 py-4 focus:text-blinest-500"},[_(C,{name:r.provider,title:r.provider,class:"mr-2 h-6 w-6 flex-shrink-0"},null,8,["name","title"])],8,Be)]),e("td",Me,[e("div",Oe,[(s(),$(L,{key:`mini-player-list-${r.id}`,track:r},null,8,["track"]))])]),e("td",Ue,[e("div",Ne,[(s(!0),a(V,null,S(r.answers,g=>(s(),a("div",{key:g.id,class:"cursor-pointer whitespace-normal break-words",onClick:ns=>b(r,g)},[e("span",Fe,l(c.__(g.type.name))+":",1),j(" "+l(g.value)+" ("+l(g.score)+"pts) ",1)],8,Te))),128)),e("button",{class:"text-neutral-400",onClick:g=>d(r)},[_(C,{name:"plus",class:"inline-block h-4 w-4 flex-shrink-0 fill-neutral-400"}),j(l(c.__("Add an answer")),1)],8,Le)])]),e("td",Ee,[e("div",Re,[_(C,{name:"thumb-up",class:"mr-2 h-6 w-6 flex-shrink-0 fill-teal-600"}),j(" "+l(r.up_votes),1)])]),e("td",ze,[e("div",De,[_(C,{name:"thumb-down",class:"mr-2 h-6 w-6 flex-shrink-0 fill-neutral-400"}),j(" "+l(r.down_votes),1)])]),e("td",Ie,[e("div",Pe,l(r.created_at),1)]),e("td",He,[_(C,{name:"delete",class:"mr-2 h-6 w-6 flex-shrink-0 cursor-pointer fill-red-400",onClick:g=>F(r)},null,8,["onClick"])])]))),128)),n.tracks.length===0?(s(),a("tr",We,[e("td",qe,l(c.__("No tracks found"))+".",1)])):A("",!0)])]),_(W,{class:"p-8",links:n.tracks.links},null,8,["links"]),p.value||w.value&&t.value?(s(),$(ie,{key:0,answer:t.value,answer_types:n.answer_types,show:w.value||p.value,"max-width":"md",onClose:z},null,8,["answer","answer_types","show"])):A("",!0)])]),_:1}))}},Ge={class:"text-xl font-bold"},Je={key:0,class:"max-w-50 max-h-80 overflow-y-auto"},Ke=["src"],Qe={class:"mr-4"},Xe=["title","onClick"],Ye={key:0},Ze=["src"],es=["title","onClick"],ss=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})],-1),ts=[ss],ls={key:1,class:"my-2 text-sm text-neutral-400"},ws={__name:"ModeratorsManager",props:{playlist:Object},setup(n){const h=n,o=y(""),t=y(!1),p=y(null),w=N({user_id:null});U(o,R(()=>{t.value=!0,axios.get("/api/users",{params:{search:o.value}}).then(u=>{p.value=u.data.users,t.value=!1})},300));const f=u=>{w.transform(i=>({user_id:u.id})).post(`/playlists/${h.playlist.id}/moderators/attach`,{preserveScroll:!0})},k=u=>{w.transform(i=>({user_id:u.id})).delete(`/playlists/${h.playlist.id}/moderators/detach`,{preserveScroll:!0})};return(u,i)=>(s(),$(T,null,{header:v(()=>[e("h3",Ge,l(u.__("Moderators")),1)]),default:v(()=>[_(E,{placement:"bottom-start",class:"mb-2 border-b pb-2",onClosed:i[1]||(i[1]=d=>o.value="")},{default:v(()=>[_(B,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=d=>o.value=d),"prepend-icon":"search","append-icon":"cheveron-down",loading:t.value,placeholder:u.__("Add a moderator")},null,8,["modelValue","loading","placeholder"])]),dropdown:v(()=>[p.value&&p.value.data.length?(s(),a("ul",Je,[(s(!0),a(V,null,S(p.value.data,d=>(s(),a("li",{key:d.id,class:"flex items-center p-2"},[d.photo?(s(),a("img",{key:0,class:"-my-2 mr-2 block h-8 w-8 rounded-full",src:d.photo},null,8,Ke)):A("",!0),e("span",Qe,l(d.name),1),e("button",{class:"ml-auto rounded-full bg-blue-500 py-1 px-2 text-xs uppercase",title:u.__("Add"),onClick:b=>f(d)},l(u.__("Add")),9,Xe)]))),128))])):A("",!0)]),_:1}),n.playlist.moderators.length?(s(),a("ul",Ye,[(s(!0),a(V,null,S(n.playlist.moderators,d=>(s(),a("li",{key:d.id,class:"flex items-center rounded p-3 hover:bg-neutral-200"},[d.photo?(s(),a("img",{key:0,class:"-my-2 mr-2 block h-8 w-8 rounded-full",src:d.photo},null,8,Ze)):A("",!0),j(" "+l(d.name)+" ",1),e("button",{class:"ml-auto text-red-500",title:u.__("Remove"),onClick:b=>k(d)},ts,8,es)]))),128))])):(s(),a("p",ls,l(u.__("No moderator")),1))]),_:1}))}},as={class:"text-xl font-bold"},os={key:0},rs={key:1,class:"my-2 text-sm text-neutral-400"},ks={__name:"RoomsList",props:{playlist:Object},setup(n){return(h,o)=>(s(),$(T,null,{header:v(()=>[e("h3",as,l(h.__("Rooms")),1)]),default:v(()=>[n.playlist.rooms.length?(s(),a("ul",os,[(s(!0),a(V,null,S(n.playlist.rooms,t=>(s(),a("li",{key:t.id,class:"flex items-center rounded p-3 hover:bg-neutral-200"},[_(m(H),{href:h.route("rooms.show",t.id)},{default:v(()=>[j(l(t.name),1)]),_:2},1032,["href"])]))),128))])):(s(),a("p",rs,l(h.__("Empty")),1))]),_:1}))}};export{ws as _,ks as a,ys as b};

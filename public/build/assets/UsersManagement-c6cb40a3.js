import{k as d,P as w,l as C,h as B,w as p,o as a,a as v,c as l,F as x,v as h,g as r,b as s,t as n,d as f,I as k,N as y}from"./app-f6824ecf.js";import{_ as V}from"./TextInput-4085333a.js";import{_ as $}from"./Dropdown-b8d92112.js";import{C as U}from"./Card-261bd2f6.js";import{_ as N}from"./BanForm-9af547d5.js";import{d as S}from"./debounce-d2fd0fa0.js";import"./Icon-1ce38a62.js";import"./v4-cf522c50.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./SelectInput-aa3e4f90.js";import"./isSymbol-363e1f0a.js";const D={key:0,class:"max-w-50 max-h-80 overflow-y-auto"},F=["src"],E={class:"mr-4"},H=["onClick"],I={key:0},j={class:"mb-4 flex w-full justify-between"},q={class:"flex items-center gap-2"},A=["src","alt"],L={class:"text-sm text-neutral-500"},M={class:"mb-4 flex w-full gap-4"},P={key:0,class:"rounded border border-neutral-600 p-2 md:w-1/2"},R=s("h3",{class:"mb-2 uppercase"},"Derniers messages",-1),T={class:"flex flex-col text-xs"},z={class:"text-neutral-500"},G={key:0,class:"text-red-500"},J={class:"break-word"},K={key:1,class:"rounded border border-neutral-600 p-2 md:w-1/2"},O=s("h3",{class:"mb-2 uppercase"},"Historique des bans",-1),Q={key:0,class:"my-2 flex flex-col"},W={class:"text-xs text-neutral-500"},X={class:"text-xs text-neutral-500"},Y={class:"text-xs text-neutral-500"},Z={class:"text-xs text-neutral-500"},ee={key:1,class:"text-sm text-neutral-500"},se={class:"flex items-center gap-2"},ve={__name:"UsersManagement",setup(te){const u=d(""),m=d(!1),i=d(!1),_=d(null),t=d(null);w({user_id:null}),C(u,S(()=>{m.value=!0,axios.get("/api/users",{params:{search:u.value}}).then(c=>{_.value=c.data.users,m.value=!1})},300));const b=c=>{t.value=c,axios.get(route("moderation.users.informations",c)).then(o=>{t.value=o.data})},g=()=>{i.value=!1,b(t.value)};return(c,o)=>(a(),B(U,null,{default:p(()=>[v($,{placement:"bottom-start",class:"mb-2 pb-2",onClosed:o[1]||(o[1]=e=>u.value="")},{default:p(()=>[v(V,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=e=>u.value=e),"prepend-icon":"search","append-icon":"cheveron-down",loading:m.value,placeholder:"Chercher un utilisateur"},null,8,["modelValue","loading"])]),dropdown:p(()=>[_.value&&_.value.data.length?(a(),l("ul",D,[(a(!0),l(x,null,h(_.value.data,e=>(a(),l("li",{key:e.id,class:"flex items-center p-2"},[e.photo?(a(),l("img",{key:0,class:"-my-2 mr-2 block h-8 w-8 rounded-full",src:e.photo},null,8,F)):r("",!0),s("span",E,n(e.name),1),s("button",{class:"ml-auto rounded-full bg-blue-500 py-1 px-2 text-xs uppercase",onClick:ae=>b(e)},"Sélectionner",8,H)]))),128))])):r("",!0)]),_:1}),t.value?(a(),l("div",I,[s("div",j,[s("div",q,[s("img",{src:t.value.photo,class:"h-10 w-10 rounded-full",alt:t.value.name},null,8,A),f(" "+n(t.value.name),1)]),s("span",L,"Inscription le "+n(t.value.created_at),1)]),s("div",M,[t.value.latest_messages?(a(),l("div",P,[R,s("ul",T,[(a(!0),l(x,null,h(t.value.latest_messages,e=>(a(),l("li",{key:e.id,class:"mb-2 flex flex-col"},[s("span",z,[f(n(e.time)+" sur "+n(e.room.name)+" : ",1),e.deleted_at?(a(),l("span",G,"[Supprimé]")):r("",!0),f(" ["+n(e.reports)+" signalements]",1)]),s("span",J,n(e.body),1)]))),128))])])):r("",!0),t.value.bans?(a(),l("div",K,[O,t.value.bans.length?(a(),l("ul",Q,[(a(!0),l(x,null,h(t.value.bans,e=>(a(),l("li",{key:e.id,class:"flex flex-col mb-2 border border-neutral-600-b border border-neutral-600-neutral-600 p-2"},[s("span",W,"Banni par : "+n(e.banned_by),1),s("span",X,"le : "+n(e.created_at),1),s("span",Y,"Raison : "+n(e.comment),1),s("span",Z,"Expire le : "+n(e.expired_at),1)]))),128))])):(a(),l("div",ee," Aucun "))])):r("",!0)]),s("div",se,[s("button",{class:"btn-secondary btn-sm",onClick:o[2]||(o[2]=e=>t.value=null)},"Fermer"),k(s("button",{class:"btn-danger btn-sm",onClick:o[3]||(o[3]=e=>i.value=!0)},"Bannir",512),[[y,!i.value]])]),k(v(N,{user:t.value,onUserBanned:g},null,8,["user"]),[[y,i.value]])])):r("",!0)]),_:1}))}};export{ve as default};

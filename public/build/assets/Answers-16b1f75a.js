import{J as D,k as m,q as M,L as F,h as P,w as f,o as n,b as t,c as r,t as a,d,g as c,a as p,v as N,F as V,f as U,u as q,_ as G}from"./app-f6824ecf.js";import{C as I}from"./Card-261bd2f6.js";import{_ as v}from"./Icon-1ce38a62.js";import"./_plugin-vue_export-helper-c27b6911.js";const J={class:"flex w-full items-center justify-between"},R=t("h3",{class:"text-xl font-bold"},"Playlist",-1),H={key:0,class:"text-xl font-bold text-neutral-500"},K={class:"text-neutral-700"},O={class:"p-2"},Q=["src","alt"],W={class:"flex-grow p-2"},X={class:"flex h-full justify-between"},Y={key:0,class:"flex items-center gap-2"},Z={key:0,class:"text-white"},ee=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",class:"h-3 w-3"},[t("path",{"fill-rule":"evenodd",d:"M13.5 4.938a7 7 0 11-9.006 1.737c.202-.257.59-.218.793.039.278.352.594.672.943.954.332.269.786-.049.773-.476a5.977 5.977 0 01.572-2.759 6.026 6.026 0 012.486-2.665c.247-.14.55-.016.677.238A6.967 6.967 0 0013.5 4.938zM14 12a4 4 0 01-4 4c-1.913 0-3.52-1.398-3.91-3.182-.093-.429.44-.643.814-.413a4.043 4.043 0 001.601.564c.303.038.531-.24.51-.544a5.975 5.975 0 011.315-4.192.447.447 0 01.431-.16A4.001 4.001 0 0114 12z","clip-rule":"evenodd"})],-1),se=[ee],te={key:1,class:"absolute -right-2 -top-1 ml-2 flex h-3 w-3 items-center justify-center rounded-full bg-purple-500 text-[11px] text-neutral-100"},le={key:1,class:"flex items-center gap-2"},oe={class:"flex-shrink-0 rounded bg-neutral-500 px-1 text-[10px] font-bold uppercase text-neutral-300 text-white"},ne={class:"hidden flex-col items-end lg:flex"},re=["href","title"],ae={key:1,class:"mt-4 flex items-center text-xs"},ie=["onClick","title"],de=["onClick","title"],_e={__name:"Answers",props:{users:Array,channel:String},setup(E){const x=E,w=D().props.auth.user,h=m([]),i=m(null),u=m([]);M(()=>{Echo.channel(x.channel).listen("RoundStarted",e=>{i.value=e.round,u.value=[],h.value=[]}).listen("TrackPlayed",e=>{i.value=e.round}).listen("TrackEnded",e=>{u.value.unshift(e.track),i.value=e.round}).listen("TrackVoted",e=>{let _=u.value.findIndex(s=>s.id===e.track.id);u.value[_].downvotes=e.track.downvotes,u.value[_].upvotes=e.track.upvotes}).listen("NewScore",e=>{e.score.user_id===w.id&&(console.log(e.score),h.value.push(e.score))})}),F(()=>{Echo.leave(x.channel)});const S=e=>{axios.post(`/rooms/${i.value.room.id}/tracks/${e.id}/downvote`)},j=e=>{axios.post(`/rooms/${i.value.room.id}/tracks/${e.id}/upvote`)};return(e,_)=>(n(),P(I,null,{header:f(()=>[t("div",J,[R,i.value?(n(),r("span",H,[t("span",K,a(i.value.current),1),d(" / "+a(i.value.tracks.length),1)])):c("",!0)])]),default:f(()=>[p(G,{name:"flip-list",tag:"ul",class:"h-64 overflow-y-scroll pr-2 md:h-80 2xl:h-96"},{default:f(()=>[(n(!0),r(V,null,N(u.value,s=>(n(),r("li",{key:s.id,class:"mb-2 flex rounded bg-neutral-900 opacity-70"},[t("div",O,[t("img",{src:s.artwork_url,alt:s.album_name,class:"h-20 w-auto rounded"},null,8,Q)]),t("div",W,[t("div",X,[t("ul",null,[(n(!0),r(V,null,N(s.answers,l=>{var k,g,y,b,A,C,T,$,B,L;return n(),r("li",{key:l.id,class:"mb-2 flex items-start overflow-ellipsis text-sm"},[(e.userAnswer=h.value.filter(o=>o.track_id===s.id&&o.answers.filter(z=>z.id===l.id)[0])[0])?(n(),r("div",Y,[t("div",{class:U(["relative flex items-center gap-1 rounded bg-purple-500 px-1 text-[10px] font-bold uppercase text-neutral-300 text-white",{"mr-1":((g=(k=e.userAnswer.answers)==null?void 0:k.filter(o=>o.id===l.id)[0])==null?void 0:g.order)<4}])},[(b=(y=e.userAnswer.answers)==null?void 0:y.filter(o=>o.id===l.id)[0])!=null&&b.speedBonus?(n(),r("span",Z,se)):c("",!0),d(" "+a(e.__((C=(A=e.userAnswer.answers)==null?void 0:A.filter(o=>o.id===l.id)[0])==null?void 0:C.name))+" ",1),(($=(T=e.userAnswer.answers)==null?void 0:T.filter(o=>o.id===l.id)[0])==null?void 0:$.order)<4?(n(),r("span",te,a((L=(B=e.userAnswer.answers)==null?void 0:B.filter(o=>o.id===l.id)[0])==null?void 0:L.order),1)):c("",!0)],2),d(" "+a(l.value),1)])):(n(),r("div",le,[t("span",oe,a(e.__(l.type.name)),1),d(" "+a(l.value),1)]))])}),128))]),t("div",ne,[s.track_url?(n(),r("a",{key:0,class:"flex items-center whitespace-nowrap text-xs opacity-50 hover:opacity-90",href:s.track_url,target:"_blank",title:e.__("Listen on")+" "+s.provider},[d(a(e.__("Listen on"))+" ",1),p(v,{name:s.provider,class:"ml-1 h-5 w-5"},null,8,["name"])],8,re)):c("",!0),q(w)?(n(),r("div",ae,[t("button",{onClick:l=>j(s),class:"mr-4 flex items-center",title:e.__("Like")},[p(v,{name:"thumb-up",class:"mr-1 h-5 w-5"}),d(" "+a(s.upvotes),1)],8,ie),t("button",{onClick:l=>S(s),class:"flex items-center",title:e.__("Don't like")},[p(v,{name:"thumb-down",class:"mr-1 h-5 w-5"}),d(" "+a(s.downvotes),1)],8,de)])):c("",!0)])])])]))),128))]),_:1})]),_:1}))}};export{_e as default};

import{e as C,g as c,h as N,i as S,E,o as l,b as r,d,w as m,c as j,k as w,a,N as B,F as x,y as b,n as k,u as P,m as y,t as p}from"./app.e47e5905.js";import{C as T}from"./Card.96514456.js";import{_ as V}from"./Icon.b99ae8d7.js";import $ from"./PodiumModal.dea6e221.js";import"./plugin-vue_export-helper.21dcd24c.js";import"./Modal.e60b654c.js";import"./Spinner.ecf8755a.js";const F={class:"flex w-full items-center justify-between"},L=a("h3",{class:"text-xl font-bold"},"Classement",-1),M=["title"],O={class:"h-64 overflow-y-scroll md:h-80 2xl:h-96 pr-2"},R={class:"flex items-center"},z=a("sup",null,"PTS",-1),J={__name:"Ranking",props:{room:Object,users:Array,channel:String,data:Object},setup(f){const n=f,h=C().props.value.auth.user,g=c([]),o=c(n==null?void 0:n.users),u=c(null),i=c(!1);return N(()=>n.users,e=>{o.value=e}),S(()=>{Echo.channel(n.channel).listen("NewScore",e=>{g.value.push(e.score);let s=o.value.findIndex(t=>t.id===e.score.user_id);o.value[s].score.total=e.score.total,o.value[s].score.points=e.score.points,o.value[s].score.answers.push(...e.score.answers)}).listen("TrackPlayed",e=>{u.value=e.track,o.value.find(s=>s.id===h.id).score.answers=[]}).listen("RoundStarted",()=>{o.value.forEach(e=>{e.score.total=0})})}),E(()=>{Echo.leave(n.channel)}),(e,s)=>(l(),r("div",null,[d(T,null,{header:m(()=>[a("div",F,[L,a("button",{type:"button",onClick:s[0]||(s[0]=t=>i.value=!0),title:e.__("Show rankings for this room")},[d(V,{name:"podium",class:"mr-2 h-8 w-8"})],8,M)])]),default:m(()=>[a("div",O,[d(B,{name:"flip-list",tag:"ul"},{default:m(()=>[(l(!0),r(x,null,b(o.value,t=>(l(),r("li",{key:t.id,class:k(["flex justify-between border-b border-neutral-600 px-2 py-4 rounded",{"bg-neutral-700":P(h).id===t.id}])},[a("div",null,[y(p(t.name)+" ",1),a("div",R,[u.value?(l(!0),r(x,{key:0},b(u.value.answers,v=>{var _;return l(),r("span",{class:k(["mr-1 rounded px-1 text-[10px] font-bold uppercase text-neutral-500 text-white",(_=t==null?void 0:t.score)!=null&&_.answers.includes(v.id)?"bg-purple-300":"bg-neutral-300"])},p(e.__(v.name)),3)}),256)):w("",!0)])]),a("div",null,[y(p(t!=null&&t.score?t.score.total:0)+" ",1),z])],2))),128))]),_:1})])]),_:1}),i.value?(l(),j($,{key:0,room:f.room,show:i.value,onClose:s[1]||(s[1]=t=>i.value=!1)},null,8,["room","show"])):w("",!0)]))}};export{J as default};
